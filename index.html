<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <title>TheGap</title>
    <script type="text/javascript" src="./d3.min.js"></script>
    <script type="text/javascript" src="./jquery.min.js"></script>
    <link href="css/style.css" media="screen" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Passion+One' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Muli' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Coda+Caption:800' rel='stylesheet' type='text/css'>    <body>
    <script type="text/javascript">
    $(document).ready(function () {
      Data = [{"category":"Cycling","event":"Individual Road Race Men","first":"6:23:49","second":"6:23:49","diff":0.0},{"category":"Cycling","event":"Individual Road Race Women","first":"3:32:24","second":"3:32:24","diff":0.0},{"category":"Canoeing","event":"K1 500m Kayak Singles (Women)","first":"1:50.673","second":"1:50.677","diff":0.004},{"category":"Rowing","event":"Double Sculls Women","first":"7:07.32","second":"7:07.33","diff":0.01},{"category":"Swimming","event":"50m Freestyle Women","first":"24.06","second":"24.07","diff":0.010000000000001563},{"category":"Swimming","event":"100m Butterfly Men","first":"50.58","second":"50.59","diff":0.010000000000005116},{"category":"Swimming","event":"100m Freestyle Women","first":"53.12","second":"53.16","diff":0.03999999999999915},{"category":"Track & Field","event":"800m Men","first":"1:44.65","second":"1:44.70","diff":0.05},{"category":"Swimming","event":"400m Freestyle Women","first":"4:03.22","second":"4:03.29","diff":0.07},{"category":"Track & Field","event":"400m Women","first":"49.62","second":"49.69","diff":0.07000000000000028},{"category":"Swimming","event":"4x100m Freestyle Relay Men","first":"3:08.24","second":"3:08.32","diff":0.08},{"category":"Canoeing","event":"K1 500m Kayak Singles (Men)","first":"1:37.252","second":"1:37.342","diff":0.09},{"category":"Canoeing","event":"K2 500m Kayak Pairs (Men)","first":"1:28.736","second":"1:28.827","diff":0.091},{"category":"Track & Field","event":"100m Hurdles Women","first":"12.54","second":"12.64","diff":0.10000000000000142},{"category":"Swimming","event":"100m Freestyle Men","first":"47.21","second":"47.32","diff":0.10999999999999943},{"category":"Swimming","event":"200m Individual Medley Women","first":"2:08.45","second":"2:08.59","diff":0.14},{"category":"Swimming","event":"50m Freestyle Men","first":"21.30","second":"21.45","diff":0.14999999999999858},{"category":"Swimming","event":"200m Freestyle Women","first":"1:54.82","second":"1:54.97","diff":0.15},{"category":"Track & Field","event":"3000m Steeplechase Men","first":"8:10.34","second":"8:10.49","diff":0.15},{"category":"Track & Field","event":"1500m Men","first":"3:32.94","second":"3:33.11","diff":0.17},{"category":"Track & Field","event":"200m Women","first":"21.74","second":"21.93","diff":0.19000000000000128},{"category":"Track & Field","event":"100m Women","first":"10.78","second":"10.98","diff":0.20000000000000107},{"category":"Track & Field","event":"100m Men","first":"9.69","second":"9.89","diff":0.20000000000000107},{"category":"Canoeing","event":"C2 1000m Canadian Pairs (Men)","first":"3:36.365","second":"3:36.588","diff":0.223},{"category":"Track & Field","event":"4x100m Relay Women","first":"42.31","second":"42.54","diff":0.22999999999999687},{"category":"Swimming","event":"100m Backstroke Women","first":"58.96","second":"59.19","diff":0.22999999999999687},{"category":"Track & Field","event":"110m Hurdles Men","first":"12.93","second":"13.17","diff":0.2400000000000002},{"category":"Canoeing","event":"C2 500m Canadian Pairs (Men)","first":"1:41.025","second":"1:41.282","diff":0.257},{"category":"Track & Field","event":"4x400m Relay Women","first":"3:18.54","second":"3:18.82","diff":0.28},{"category":"Swimming","event":"100m Breaststroke Men","first":"58.91","second":"59.20","diff":0.29000000000000625},{"category":"Swimming","event":"100m Butterfly Women","first":"56.73","second":"57.10","diff":0.37000000000000455},{"category":"Swimming","event":"200m Backstroke Men","first":"1:53.94","second":"1:54.33","diff":0.39},{"category":"Cycling","event":"BMX Individual Men","first":"36.19","second":"36.606","diff":0.4160000000000039},{"category":"Swimming","event":"400m Individual Medley Women","first":"4:29.45","second":"4:29.89","diff":0.44},{"category":"Rowing","event":"Single Sculls Women","first":"7:22.34","second":"7:22.78","diff":0.44},{"category":"Cycling","event":"Team sprint Men","first":"43.128","second":"43.651","diff":0.5230000000000032},{"category":"Swimming","event":"200m Butterfly Women","first":"2:04.18","second":"2:04.72","diff":0.54},{"category":"Swimming","event":"4x100m Freestyle Relay Women","first":"3:33.76","second":"3:34.33","diff":0.57},{"category":"Swimming","event":"100m Backstroke Men","first":"52.54","second":"53.11","diff":0.5700000000000003},{"category":"Swimming","event":"400m Freestyle Men","first":"3:41.86","second":"3:42.44","diff":0.58},{"category":"Swimming","event":"4x100m Medley Relay Women","first":"3:52.69","second":"3:53.30","diff":0.61},{"category":"Track & Field","event":"200m Men","first":"19.3","second":"19.96","diff":0.6600000000000001},{"category":"Swimming","event":"200m Butterfly Men","first":"1:52.03","second":"1:52.70","diff":0.67},{"category":"Swimming","event":"1500m Freestyle Men","first":"14:40.84","second":"14:41.53","diff":0.69},{"category":"Swimming","event":"4x100m Medley Relay Men","first":"3:29.34","second":"3:30.04","diff":0.7},{"category":"Track & Field","event":"400m Hurdles Men","first":"47.25","second":"47.98","diff":0.7299999999999969},{"category":"Rowing","event":"Lightweight Double Sculls Men","first":"6:10.99","second":"6:11.72","diff":0.73},{"category":"Canoeing","event":"K4 500m Kayak Fours (Women)","first":"1:32.231","second":"1:32.971","diff":0.74},{"category":"Canoeing","event":"K2 500m Kayak Pairs (Women)","first":"1:41.308","second":"1:42.092","diff":0.784},{"category":"Rowing","event":"Single Sculls Men","first":"6:59.83","second":"7:00.63","diff":0.8},{"category":"Canoeing","event":"K4 1000m Kayak Fours (Men)","first":"2:55.714","second":"2:56.593","diff":0.879},{"category":"Track & Field","event":"4x100m Relay Men","first":"37.10","second":"38.06","diff":0.9600000000000009},{"category":"Swimming","event":"200m Backstroke Women","first":"2:05.24","second":"2:06.23","diff":0.99},{"category":"Track & Field","event":"400m Men","first":"43.75","second":"44.74","diff":0.990000000000002},{"category":"Cycling","event":"Madison Men","first":"7","second":"8","diff":1.0},{"category":"Sailing","event":"RSX Windsurfer Men","first":"52","second":"53","diff":1.0},{"category":"Sailing","event":"RSX Windsurfer Women","first":"39","second":"40","diff":1.0},{"category":"Canoeing","event":"K1 1000m Kayak Singles (Men)","first":"3:26.323","second":"3:27.342","diff":1.019},{"category":"Track & Field","event":"400m Hurdles Women","first":"52.64","second":"53.70","diff":1.0600000000000023},{"category":"Track & Field","event":"800m Women","first":"1:54.87","second":"1:56.07","diff":1.2},{"category":"Rowing","event":"Eights Men","first":"5:23.89","second":"5:25.11","diff":1.22},{"category":"Swimming","event":"200m Breaststroke Men","first":"2:07.64","second":"2:08.88","diff":1.24},{"category":"Canoeing","event":"C1 500m Canadian Singles (Men)","first":"1:47.140","second":"1:48.397","diff":1.257},{"category":"Rowing","event":"Double Sculls Men","first":"6:27.77","second":"6:29.05","diff":1.28},{"category":"Rowing","event":"Coxless Fours Men","first":"6:06.57","second":"6:07.85","diff":1.28},{"category":"Rowing","event":"Lightweight Double Sculls Women","first":"6:54.74","second":"6:56.03","diff":1.29},{"category":"Rowing","event":"Quadruple Sculls Women","first":"6:16.06","second":"6:17.37","diff":1.31},{"category":"Track & Field","event":"5000m Women","first":"15:41.40","second":"15:42.74","diff":1.34},{"category":"Track & Field","event":"1500m Women","first":"4:00.23","second":"4:01.63","diff":1.4},{"category":"Swimming","event":"10km Marathon Women","first":"1:59:27.7","second":"1:59:29.2","diff":1.5},{"category":"Swimming","event":"100m Breaststroke Women","first":"1:05.17","second":"1:06.73","diff":1.56},{"category":"Track & Field","event":"10000m Men","first":"27:01.17","second":"27:02.77","diff":1.6},{"category":"Canoeing","event":"K1 Kayak Slalom Singles (Men)","first":"171.7","second":"173.30","diff":1.6000000000000227},{"category":"Swimming","event":"4x200m Freestyle Relay Women","first":"7:44.31","second":"7:45.93","diff":1.62},{"category":"Rowing","event":"Lightweight Coxless Fours Men","first":"5:47.76","second":"5:49.39","diff":1.63},{"category":"Rowing","event":"Coxless Pairs Women","first":"7:20.60","second":"7:22.28","diff":1.68},{"category":"Track & Field","event":"10000m Women","first":"29:54.66","second":"29:56.34","diff":1.68},{"category":"Canoeing","event":"K2 1000m Kayak Pairs (Men)","first":"3:11.809","second":"3:13.580","diff":1.771},{"category":"Swimming","event":"200m Breaststroke Women","first":"2:20.22","second":"2:22.05","diff":1.83},{"category":"Rowing","event":"Eights Women","first":"6:05.34","second":"6:07.22","diff":1.88},{"category":"Swimming","event":"200m Freestyle Men","first":"1:42.96","second":"1:44.85","diff":1.89},{"category":"Canoeing","event":"C1 Canadian Slalom Singles (Men)","first":"176.65","second":"178.61","diff":1.960000000000008},{"category":"Cycling","event":"Points Race Men","first":"58","second":"60","diff":2.0},{"category":"Swimming","event":"10km Marathon Men","first":"1:51:51.6","second":"1:51:53.6","diff":2.0},{"category":"Cycling","event":"BMX Individual Women","first":"35.976","second":"38.042","diff":2.0660000000000025},{"category":"Canoeing","event":"C2 Canadian Slalom Pairs (Men)","first":"190.82","second":"192.89","diff":2.069999999999993},{"category":"Cycling","event":"Individual Pursuit Women","first":"3:28.321","second":"3:30.395","diff":2.074},{"category":"Rowing","event":"Coxless Pairs Men","first":"6:37.44","second":"6:39.55","diff":2.11},{"category":"Rowing","event":"Quadruple Sculls Men","first":"5:41.33","second":"5:43.57","diff":2.24},{"category":"Canoeing","event":"C1 1000m Canadian Singles (Men)","first":"3:50.467","second":"3:52.751","diff":2.284},{"category":"Swimming","event":"200m Individual Medley Men","first":"1:54.23","second":"1:56.52","diff":2.29},{"category":"Swimming","event":"400m Individual Medley Men","first":"4:03.84","second":"4:06.16","diff":2.32},{"category":"Cycling","event":"4000m Individual Pursuit Men","first":"4:16.977","second":"4:19.611","diff":2.634},{"category":"Track & Field","event":"4x400m Relay Men","first":"2:55.39","second":"2:58.03","diff":2.64},{"category":"Sailing","event":"49er","first":"61","second":"64","diff":3.0},{"category":"Track & Field","event":"5000m Men","first":"12:57.82","second":"13:02.80","diff":4.98},{"category":"Sailing","event":"Laser Radial Women","first":"37","second":"42","diff":5.0},{"category":"Triathlon","event":"Triathlon Men","first":"1:48:53","second":"1:48:58","diff":5.0},{"category":"Sailing","event":"Tornado","first":"44","second":"49","diff":5.0},{"category":"Swimming","event":"4x200m Freestyle Relay Men","first":"6:58.56","second":"7:03.70","diff":5.14},{"category":"Swimming","event":"800m Freestyle Women","first":"8:14.10","second":"8:20.23","diff":6.13},{"category":"Cycling","event":"4000m Team Pursuit Men","first":"3:53.314","second":"4:00.040","diff":6.726},{"category":"Sailing","event":"Laser Men","first":"63","second":"71","diff":8.0},{"category":"Track & Field","event":"3000m Steeplechase Women","first":"8:58.81","second":"9:07.41","diff":8.6},{"category":"Sailing","event":"Yngling Women","first":"21","second":"31","diff":10.0},{"category":"Sailing","event":"470 Women","first":"43","second":"53","diff":10.0},{"category":"Cycling","event":"Points Race Women","first":"18","second":"30","diff":12.0},{"category":"Track & Field","event":"20km Walk Men","first":"1:19:01","second":"1:19:15","diff":14.0},{"category":"Canoeing","event":"K1 Kayak Slalom Singles (Women)","first":"192.64","second":"206.94","diff":14.300000000000011},{"category":"Sailing","event":"Finn Men","first":"23","second":"45","diff":22.0},{"category":"Track & Field","event":"Marathon Women","first":"2:26:44","second":"2:27:06","diff":22.0},{"category":"Cycling","event":"Individual Road Time Trial Women","first":"34:51.72","second":"35:16.01","diff":24.29},{"category":"Sailing","event":"470 Men","first":"44","second":"75","diff":31.0},{"category":"Cycling","event":"Individual Road Time Trial Men","first":"1:02:11.43","second":"1:02:44.79","diff":33.36},{"category":"Track & Field","event":"20km Walk Women","first":"1:26:31","second":"1:27:07","diff":36.0},{"category":"Cycling","event":"Cross-country Women","first":"1:45:11","second":"1:45:52","diff":41.0},{"category":"Track & Field","event":"Marathon Men","first":"2:06:32","second":"2:07:16","diff":44.0},{"category":"Cycling","event":"Cross-country Men","first":"1:55:59","second":"1:57:06","diff":67.0},{"category":"Triathlon","event":"Triathlon Women","first":"1:58:27","second":"1:59:34","diff":67.0},{"category":"Track & Field","event":"50km Walk Men","first":"3:37:09","second":"3:39:27","diff":138.0}]
      var w = 1500,
          h = 650,
          margin = 500,
          gap = 10,
          dict = {},
          border = w - margin,
          counts = border / gap,
          z = d3.scale.category20c(),
          i = 0;
      
      var colors = [
        '#1f77b4', 
        '#ff7f0e', 
        '#2ca02c', 
        '#d62728',
        '#9467bd', 
        '#8c564b' ,
        '#e377c2', 
        '#7f7f7f', 
        '#bcbd22', 
        '#17becf'
      ]
      
      Data.forEach(function(d){
        if (!dict[d.category]) {
          dict[d.category] = colors.shift()
        };
      })


      var svg = d3.select("#track").append("svg:svg")
          .attr("width", w)
          .attr("height", h)
          .style("pointer-events", "all")

      function drawLine(y, interval, d){
        var counter = 0;
        var startTime = new Date();      
        var id;
        var drawDots = function(y){
          counter = counter + gap ;
          particle(counter,y,{color:dict[d.category]});
          if (counter > border) {
            var endTime = new Date();
            console.log(interval, endTime - startTime, d.diff)
            particle(counter - 20 ,y, {color:dict[d.category] , r:10});
            if (y == 50) {
              svg.append('text')
                .attr('x', border + 10)
                .attr('y',y - 30)
                .text(function(){
                  return 'Gold - Silver diff(sec) : category : event : Gold time';
                })
                .style('stroke', 'grey');
              svg.append('text')
                .attr('x', border + 10)
                .attr('y',y - 12)
                .text(function(){
                  return '------------ : -------- : ----- : -------------------';
                })
                .style('stroke','grey');


            };
            if (y > 510) {
              $('#tips').show();
            };
            svg.append('text')
              .attr('x', border + 10)
              .attr('y',y)
              .text(function(){
                return d.diff.toPrecision(5) +  ' sec : ' + d.category + ' : ' + d.event + ' : ' + d.first;
              })
              .style('stroke',dict[d.category])
              .style("stroke-opacity", 1);
            
            
          
            window.clearInterval(id);
          };
        }

        id = setInterval(function(){drawDots(y)},interval);
      }

      function speedToInterval(speed){
        return speed / counts * 1000;
      }

      function drawLines(){
        for (var i=0; i < Data.length; i=i+5) {
          d = Data[i]
          drawLine(50 + (i * 5),  speedToInterval(d.diff), d);
        };
      }

      function particle(x, y, options) {
        var color = options.color || 'red'
        var r = options.r || 2
        svg.append("svg:circle")
            .attr("cx", x)
            .attr("cy", y)
            .attr("r", r)
            .style("stroke", color)
            .style("stroke-opacity", 1)
          .transition()
            .duration(5000)
            .ease(Math.sqrt)
            .attr("r", r * 5)
            .style("stroke-opacity", 1e-6)
            .remove();
      }
      
      $('#tips').hide();
      $('button').click(drawLines)
    });
    </script>
  <h1>The Gap</h1>
  <div>
    Visualise the time difference between the gold and the silver of 2008 games. The data is taken from <a href="http://www.databaseolympics.com">www.databaseolympics.com</a>. Visualized by <a href="http://d3js.org">d3</a>
  </div>
  <button class="button">Run</button>
  <div id="track">
  </div>
  <div id="tips">
    Did you know? The longest gap was Track & Field 50km Walk Men. Gold 3:37:09,Silver 3:39:27. The difference was 138.0 seconds. The full data is at <a href="./data2.txt">data2.txt</a>
  </div>
  
  </body>
</html>
